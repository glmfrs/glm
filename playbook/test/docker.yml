---
- hosts: all
  remote_user: root
  vars:
    #proxy_env:
    #  http_proxy:
    #  https_proxy:
  tasks:

  - name: apt upgrade
    apt:
      name: '*'
      state: latest
      update_cache: yes
    # environment: "{{ proxy_env }}"

  - name: apt distupgrade
    apt:
      upgrade: dist
      update_cache: yes
    # environment: "{{ proxy_env }}"

  - name: installation des paquets
    apt:
      name:
        - docker.io
        - python3
        - python3-pip
        - python3-setuptools
      state: latest
      update_cache: yes
    ignore_errors: yes
    # environment: "{{ proxy_env }}"

  #- name: pip docker
  #  pip:
  #    name: docker

  - name: docker test
    docker_image:
      name: hello-world
      source: pull
    # environment: "{{ proxy_env }}"